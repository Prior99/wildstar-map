<!DOCTYPE HTML>
<html>
    <head>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
        <script src="js/graphics.js"></script>
        <script src="js/mouse.js"></script>
        <script src="js/index.js"></script>
        <script src="js/context.js"></script>
        <script src="js/websocket.js"></script>
        <script src="js/connection.js"></script>
        <script src="js/drawables/cursor.js"></script>
        <script src="js/drawables/zoomometer.js"></script>
        <script src="js/drawables/fps.js"></script>
        <script src="port.js"></script>
        <style>
            html, body {
                font-family: "Verdana";
                padding: 0;
                margin: 0;
                width: 100%;
                height: 100%;
            }
            canvas {
                position: absolute;
                left: 0px;
                top: 0px;
                display: block;
                cursor: none;
            }
            canvas#map {
                background-color: #2f76bb;
            }
            canvas#overlay {
                background-color: transparent;
            }
            #wrapper {
                padding: 30px;
            }
            div.context {
                width: 200px;
                border: black;
                background-color: white;
                position: absolute;
                min-height: 20px;
                padding: 0;
            }
            div.context a {
                width: 190px;
                display: inline-block;
                height: 20px;
                background-color: white;
                padding: 5px;
            }
            div.context a:hover {
                background-color: lightblue;
            }
        </style>
    </head>
    <body>
        <div id="wrapper">
            <h1>Maps - Index</h1>
        </div>
        </canvas>
        <script>
            function ShowMap(map) {
                $.ajax({
                    url : map + "/descriptor.json",
                    success : function(obj) {
                        $("body").html("");
                        var canvas = $("<canvas id='map'></canvas>").appendTo("body")[0];
                        var overlaycanvas = $("<canvas id='overlay'></canvas>").appendTo("body")[0];
                        var mouse = new Mouse(overlaycanvas);
                        var graphics = new Graphics(canvas, overlaycanvas, obj, mouse, map);
                        graphics.addDrawable(new Cursor(mouse));
                        graphics.addDrawable(new Zoomometer(graphics, {
                            x : 30,
                            y : 100
                        }));
                        graphics.addDrawable(new FPS(graphics, {
                            x : 30,
                            y : 30
                        }));
                        var context = new Context(mouse);
                        context.addEntry("Test", function() {
                            alert("hi");
                        });
                        context.addEntry("Log", function() {
                            console.log("hi");
                        });
                    }
                });
            }

            $(function() {
                new Connection();
                Websocket.init();
                Index($("<ul></ul>").appendTo("#wrapper"));
            });
        </script>
    </body>
</html>
